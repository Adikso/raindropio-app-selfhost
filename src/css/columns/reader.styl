@require "animations.styl"

#reader {
    background: white;
    box-shadow: inset 1px 0px 0px separatorColor;
    z-index: 6;
    left: 101%;
    //opacity: 0;
    width: 100vw;
    //min-width: 30%;
    will-change: left, width;

    > header {
        background: white;
        box-shadow:  /*0px 1px 0px separatorColor,*/ inset 1px 0px 0px separatorColor;
        position: relative;
        left:0;top:0;right:0;
        z-index: 2;
        
        .tabs .item.active:after {
            display: none;
        }
        
        .button:not(:first-of-type):not(:last-of-type) {
            padding-left:10px;
            padding-right:10px;
        }
        
        .button:first-of-type {
            padding-right: 10px;
        }
        
        .button:last-of-type {
            padding-left: 10px;
        }
    }

    .readerContentHeaderPlaceholder {
        height: rem(48px);
        display: none;
    }

    .fab-fonts {
        opacity:0;
        pointer-events:none;
        transition: opacity .2s ease-in-out;
    }

    &[data-tab="preview"] {
        > header, > footer {
            position: absolute;
            transition: opacity .15s ease-in-out, transform .15s ease-in-out;
        }
        
        .readerContentHeaderPlaceholder {
            display:block;
        }
        
        .readerContent {
            padding-bottom: 34px;
        }
    }

    &[data-tab="preview"].scrolled {
        > header, > footer {
            opacity: 0;
            
            &:hover {
                opacity:.95;
                transform: translateY(0);
            }
        }

        > header {
            transform: translateY(-10px);
            box-shadow: 0px 1px 0px separatorColor, inset 1px 0px 0px separatorColor;
        }
        
        > footer {
            transform: translateY(10px);
        }
    }
}

html.retina.chrome {
    #reader {
        box-shadow: inset 0.5px 0px 0px rgba(0,0,0,.15);
        
        > header {
            box-shadow: inset 0.5px 0px 0px rgba(0,0,0,.15);
        }
    }
}

.superFrame {
    &:after {
        position:absolute;left:0;top:0;bottom:0;
        width:1px;
        pointer-events:none;
        z-index:2;
        content:" ";
    }

    iframe, webview {
        display: block;
        flex:1;
        border:0;
        box-shadow:none;
        overflow-y: auto;
        position:relative;
        z-index:1;
        background: white;
        
        &::-webkit-scrollbar {
            width: scrollBarWidth !important;
        }

        &.loading {
            background:transparent;
        }
    }

    webview {
        display: flex;
    }

    .superFrame-error {
        .subHeadLabel {
            max-width: 100%;
        }
    }

    .superFrame-screenshot-wrap {
        box-shadow: 0px 0px 0px 1px rgba(0,0,0,.07), 0px 20px 50px rgba(0,0,0,.07);
        border-radius: 2px;
        background:white;
        overflow: hidden;
        position: relative;
        display:block;
        background: readerErrorBackground;
        cursor: pointer;
        width: 480px;
        min-height: 338px;
        margin: 0 auto;
        margin-top: 30px;

        .preloader {
            position: absolute;
            left: 50%;top:50%;
            margin-left: -25px;
            margin-top:-25px;
        }
        
        .superFrame-screenshot {
            border-radius: 2px;
            display:block;
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: top center;
            position: relative;
            z-index:1;
        }
    }
}

#reader .superFrame:after {
    box-shadow:inset 1px 0px 0px separatorColor;
}

html.retina.chrome {
    #reader .superFrame {
        &:after {
            box-shadow:inset 0.5px 0px 0px darken(separatorColor,5%);
        }
    }
}

#reader-black-overlay {
    z-index: 10;
    background: radial-gradient(rgba(0,0,0,0.03), rgba(0,0,0,0.17));
    opacity: 0;
    transition: opacity layoutTransitionSpeed ease-in-out;
    position: absolute;left:0;right: 0;bottom: 0;top: 0;
    pointer-events: none;
}
#reader {
    width: "calc(100vw - %s)" % (sidebarWidth + mainCollapsedWidth);
    width: calc(100vw - calc(var(--sidebarWidth, sidebarWidth) + var(--mainCollapsedWidth,mainCollapsedWidth)));
}


#reader footer.readMore {
    //height: 34px;
    background: inherit;
    bottom: 0;
    width: 100%;right:0;left:0;
    box-shadow: 0px -1px 0px separatorColor, inset 1px 0px 0px separatorColor;
    
    .center {
            justify-content: center;
    }
}
html.retina.chrome #reader footer.readMore {
    box-shadow: 0px -1px 0px separatorColor, inset 0.5px 0px 0px separatorColor;
}


.mode-reader #reader {
    left: (sidebarWidth + mainCollapsedWidth);
    left: calc(var(--sidebarWidth, sidebarWidth) + var(--mainCollapsedWidth,mainCollapsedWidth));
    
    //right: 0;
    //opacity: 1;

    .fab-fonts {
        opacity:1;
        pointer-events:auto;
    }
}

.mode-force-sidebar #sidebar {
    transform: translateX(0) !important;
}

.mode-reader.mode-reader-fullscreen #reader {
    left: 0 !important;
    width: 100vw !important;
    box-shadow: none;

    .preview.preview-type-image {
        left:0;
    }
}

.mode-reader-modal, .mode-reader-fullscreen {
    #reader {
        z-index: 11;
    }
    #reader header {
        box-shadow: none;
    }
    
    #reader .superFrame:after {
        box-shadow:none;
    }
}

.mode-reader-modal {
    #reader {
        transform: translateY(120vh);
        transition: transform layoutTransitionSpeed ease-in-out;
    }
}

.mode-reader.mode-reader-modal {
    #reader {
        transform: translateY(0) !important;
    }
}

.mode-reader.mode-reader-modal:not(.mode-reader-fullscreen) {
    #reader {
        width: 70vw !important;
        left: 15vw !important;
        box-shadow: 0px 0px 0px 1px rgba(0,0,0,.1), 0px 10px 25px rgba(0,0,0,.1);
    }
    #reader-black-overlay {
        opacity: 1;
        pointer-events: auto;
    }
}